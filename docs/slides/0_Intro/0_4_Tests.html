<!DOCTYPE html>


<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>5. Tema 4: Tests d’hipòtesis &mdash; 104392 - Modelització i Inferència 2020.08.04 documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/styles.css" type="text/css" />
    <link rel="stylesheet" href="../_static/slides.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <link rel="stylesheet" href="../_static/../../html/_static/sab-slides.css" type="text/css" />
    
    
    
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2020.08.04',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/common.js"></script>
    
    <script type="text/javascript" src="../_static/slides.js"></script>
    <script type="text/javascript" src="../_static/sync.js"></script>
    <script type="text/javascript" src="../_static/controller.js"></script>
    <script type="text/javascript" src="../_static/init.js"></script>
    
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="104392 - Modelització i Inferència 2020.08.04 documentation" href="../index.html" />
    <link rel="prev" title="4. Tema 3: Estimació" href="0_3_Estimacio.html" /> 
  </head>
  <body>

<section
   id="slide_container"
   class='slides layout-regular'>


  
<article class="slide level-1" id="tema-4-tests-d-hipotesis">

<h1>Tema 4: Tests d’hipòtesis</h1>




<div class="slide-no">1</div>


<div class="slide-footer">104392 - Modelització i Inferència - 2020</div>

</article>
<article class="slide level-2" id="rao-de-versemblances-i-neyman-pearson">

<h2>Raó de Versemblances i Neyman-Pearson</h2>




<div class="slide-no">2</div>


<div class="slide-footer">104392 - Modelització i Inferència - 2020</div>

</article>
<article class="slide level-3" id="exemple-de-motivacio">

<h3>Exemple de motivació</h3>

<p>Començarem considerant un dels exemples que
vam veure al Tema 2:</p>
<ul class="simple">
<li>Tenim un circuit integrat per K components en sèrie</li>
<li>El fabricant dels components ens assegura que cada component té una proba diària de fallar <span class="math notranslate nohighlight">\(\rho_X &lt; 0.01\)</span></li>
</ul>
<p>Durant els nostres experiments de control de qualitat, observem
que el circuit falla després  de 57, 49, 8, 234, 4, 181, 153,22,  91,  11 dies.</p>
<p class="note">Està respectant el fabricant de components la garantia?</p>



<div class="slide-no">3</div>


<div class="slide-footer">104392 - Modelització i Inferència - 2020</div>

</article>
<article class="slide level-3" id="id1">

<h3>Exemple de motivació (2)</h3>

<p>Al Tema 2, vem aprendre que <span class="math notranslate nohighlight">\(Y\)</span>, el temps de vida del circuit,
seguia una distribució geomètrica amb paràmetre <span class="math notranslate nohighlight">\(\rho_Y = 1 - (1-\rho_X)^K\)</span>,
i vem derivar-ne l’EMV:</p>
<div class="math notranslate nohighlight">
\[\hat{\rho}_Y = \frac{N}{\sum_i y_i}\]</div>
<p>Apartir d’això vam estimar:</p>
<div class="math notranslate nohighlight">
\[\hat{\rho}_X = 1 - (1 - \hat{\rho}_Y)^\frac{1}{K} \approx 0.001\]</div>
<p>i vam concloure que el fabricant estava respectant la garantia, ja que <span class="math notranslate nohighlight">\(\hat{\rho}_X \ll 0.01\)</span>.</p>
<p class="note">Però què decidirieu si ens hagués sortit <span class="math notranslate nohighlight">\(\hat{\rho}_X \approx 0.01\)</span>? O <span class="math notranslate nohighlight">\(\hat{\rho}_X \approx 0.008\)</span>?</p>



<div class="slide-no">4</div>


<div class="slide-footer">104392 - Modelització i Inferència - 2020</div>

</article>
<article class="slide level-3" id="id2">

<h3>Exemple de motivació (3)</h3>

<p>De la teoria del Tema 2, sabem que l’EMV <span class="math notranslate nohighlight">\(\hat{\rho}_Y\)</span> és
una quantitat aleatòria, i per tant <span class="math notranslate nohighlight">\(\hat{\rho}_X\)</span> també. Per
exemple, vegem la distribució de <span class="math notranslate nohighlight">\(\hat{\rho}_X\)</span> quan <span class="math notranslate nohighlight">\(\rho_X=0.008\)</span>:</p>
<a class="reference internal image-reference" href="../_images/geom_null.png"><img alt="../_images/geom_null.png" class="align-center" src="../_images/geom_null.png" style="height: 250px;" /></a>
<p class="note">Quan <span class="math notranslate nohighlight">\(\rho_X = 0.008\)</span>, <span class="math notranslate nohighlight">\(P(\hat{\rho}_X &gt; 0.01; \rho_X = 0.008) \approx 37\%\)</span>! Si
<span class="math notranslate nohighlight">\(\rho_X = 0.0001\)</span>, aquesta probabilitat és més petita, però no és nula. Això és
degut a l’error d’estimació (l’EMV és consistent asimptòticament, però estem treballant amb mostres finites!).
Això s’anomena un <strong>Fals Positiu</strong>.</p>



<div class="slide-no">5</div>


<div class="slide-footer">104392 - Modelització i Inferència - 2020</div>

</article>
<article class="slide level-3" id="id3">

<h3>Exemple de motivació (4)</h3>

<p>Per altra banda, suposem que <span class="math notranslate nohighlight">\(\rho_X = 0.02\)</span> (2x més gran que 1%).
Degut a l’aleatorietat de <span class="math notranslate nohighlight">\(\hat{\rho}_X\)</span>, també
tindrem una probabilitat no nula de que <span class="math notranslate nohighlight">\(\hat{\rho}_X &lt; 0.01\)</span>:</p>
<a class="reference internal image-reference" href="../_images/geom_H1.png"><img alt="../_images/geom_H1.png" class="align-center" src="../_images/geom_H1.png" style="height: 250px;" /></a>
<p class="note">Decidir que, en base a les observacions, <span class="math notranslate nohighlight">\(\rho_X &lt; 0.01\)</span> quan en realitat <span class="math notranslate nohighlight">\(\rho_X &gt; 0.01\)</span> s’anomena un <strong>Fals Negatiu</strong>.</p>



<div class="slide-no">6</div>


<div class="slide-footer">104392 - Modelització i Inferència - 2020</div>

</article>
<article class="slide level-3" id="id4">

<h3>Exemple de motivació (5)</h3>

<p>Malgrat aquestes dues observacions, la intuició ens diu que si
<span class="math notranslate nohighlight">\(\hat{\rho}_X\)</span> és molt més petit que <span class="math notranslate nohighlight">\(\rho_c = 0.01\)</span>,
o de manera equivalent, <span class="math notranslate nohighlight">\(T := \hat{\rho}_X - \rho_c\)</span> és prou
petit, hauriem de poder afirmar que <span class="math notranslate nohighlight">\(\rho_X\)</span> és efectivament
més petit que 0.01 i per tant el fabricant està complint la garantia.</p>
<p>Ja podem definir alguns conceptes claus:</p>
<ul class="simple">
<li><span class="math notranslate nohighlight">\(T\)</span> s’anomena <strong>l’estadístic del test</strong>, que calculem a partir de la mostra (en aquest exemple depèn de <span class="math notranslate nohighlight">\(\hat{\rho}_X\)</span>)</li>
<li>El valor <span class="math notranslate nohighlight">\(T_0\)</span> contra el que comparem <span class="math notranslate nohighlight">\(T\)</span> per tal de prendre una decisió, s’anomena <strong>valor crític</strong>.</li>
<li>El conjunt  <span class="math notranslate nohighlight">\(T \leq T_0\)</span> s’anomena <strong>regió d’acceptació del test</strong>, el complementari és la <strong>regió crítica</strong>.</li>
</ul>
<p class="note">Quan escollim <span class="math notranslate nohighlight">\(T_0\)</span>, determinem implícitament
la quantitat de Falsos Positius i Falsos Negatius que tindrem. En <strong>aquest exemple</strong>, quan més gran <span class="math notranslate nohighlight">\(T_0\)</span>, menys
“estricte” és el nostre criteri, i per tant més Falsos Positius i menys Falsos Negatius. Quan més petit, a l’inversa.</p>



<div class="slide-no">7</div>


<div class="slide-footer">104392 - Modelització i Inferència - 2020</div>

</article>
<article class="slide level-3" id="el-paradigma-de-neyman-pearson-i-fisher">

<h3>El paradigma de Neyman-Pearson i Fisher</h3>

<p>La intuició que estem fent servir sembla raonable però ens falta una manera quantitativa
d’escollir quan <span class="math notranslate nohighlight">\(T\)</span> és “prou petit” o no (és a dir, escollir el valor crític <span class="math notranslate nohighlight">\(T_0\)</span>.)
El paradigma que utilitzarem ens permetrà fer això. Però primer haurem de definir una sèrie de conceptes:</p>
<ul class="simple">
<li><strong>L’Hipòtesis Nula</strong> (<span class="math notranslate nohighlight">\(H_0\)</span>): És l’hipòtesi sobre <strong>el model estadístic</strong> que volem contrastar/refutar</li>
<li><strong>L’Hipòtesis Alternativa</strong> (<span class="math notranslate nohighlight">\(H_1\)</span>): És l’alternativa de l’hipòtesi nula (no necessàriament complementària!)</li>
<li><strong>L’Error de Tipus I</strong> o Fals Positiu: Quan el nostre test refusa <span class="math notranslate nohighlight">\(H_0\)</span> quan aquesta és certa</li>
<li><strong>L’Error de Tipus II</strong> o Fals Negatiu: Quan el nostre test accepta <span class="math notranslate nohighlight">\(H_0\)</span> quan <span class="math notranslate nohighlight">\(H_1\)</span> és certa</li>
<li><span class="math notranslate nohighlight">\(\alpha = P(\mbox{refusar } H_0 ; H_0)\)</span>: el <strong>nivell de significació</strong> o probabilitat d’Error de Tipus I</li>
<li><span class="math notranslate nohighlight">\(\beta = P(\mbox{acceptar } H_0 ; H_1)\)</span>: la probabilitat d’Error de Tipus II</li>
<li><strong>La potència del test</strong> (<em>power</em>): <span class="math notranslate nohighlight">\(1 - \beta\)</span>, la probabilitat <span class="math notranslate nohighlight">\(P(\mbox{refusar } H_0 ; H_1)\)</span>.</li>
</ul>



<div class="slide-no">8</div>


<div class="slide-footer">104392 - Modelització i Inferència - 2020</div>

</article>
<article class="slide level-3" id="id5">

<h3>El paradigma de Neyman-Pearson i Fisher (2)</h3>

<p>Per tant, per especificar un test i caracteritzar-lo, necessitarem especificar <span class="math notranslate nohighlight">\(H_0\)</span>,
<span class="math notranslate nohighlight">\(H_1\)</span>, i la regió crítica…</p>
<ul class="simple">
<li>Fixeu-vos que, intuitivament, hi ha una tensió entre <span class="math notranslate nohighlight">\(\alpha\)</span> i <span class="math notranslate nohighlight">\(1- \beta\)</span>.</li>
<li>En teoria, el test ideal és el que té <span class="math notranslate nohighlight">\(\alpha=0\)</span> i <span class="math notranslate nohighlight">\(1 - \beta = 1\)</span>, és a dir no fa cap fals positiu ni cap fals negatiu.</li>
<li>A la pràctica el test ideal no existeix, i ens conformarem amb els tests que, donat <span class="math notranslate nohighlight">\(\alpha\)</span>, tenen millor potència.</li>
</ul>



<div class="slide-no">9</div>


<div class="slide-footer">104392 - Modelització i Inferència - 2020</div>

</article>
<article class="slide level-3" id="id6">

<h3>Al nostre exemple inicial:</h3>

<ul class="simple">
<li><span class="math notranslate nohighlight">\(H_0\)</span>: <span class="math notranslate nohighlight">\(\rho_X \leq 0.01\)</span>, és a dir el fabricant ens diu la veritat</li>
<li><span class="math notranslate nohighlight">\(H_1\)</span>: <span class="math notranslate nohighlight">\(\rho_X &gt; 0.01\)</span>, és a dir el fabricant ens ha mentit</li>
<li><strong>La regió crítica</strong>: <span class="math notranslate nohighlight">\(T &gt; T_0\)</span> on rebutjem <span class="math notranslate nohighlight">\(H_0\)</span></li>
<li><strong>L’Error de Tipus I</strong>: L’estadístic ens dona <span class="math notranslate nohighlight">\(T &gt; T_0\)</span> però <span class="math notranslate nohighlight">\(\rho_X \leq 0.01\)</span>.</li>
<li><strong>L’Error de Tipus II</strong>: L’estadístic ens dona <span class="math notranslate nohighlight">\(T \leq T_0\)</span> però <span class="math notranslate nohighlight">\(\rho_X &gt; 0.01\)</span>.</li>
</ul>
<p>Normalment primer escollirem un nivell de significació <span class="math notranslate nohighlight">\(\alpha\)</span>, i a partir del mateix
escollirem <span class="math notranslate nohighlight">\(T_0\)</span> de manera que:</p>
<div class="math notranslate nohighlight">
\[P(T &gt; T_0 ; H_0) = \alpha\]</div>
<p>Això determinarà implícitament la potència del test <span class="math notranslate nohighlight">\(1 - \beta = P(T &gt; T_0 ; H_1)\)</span>.</p>
<p class="note">Fixeu-vos que hi ha una “asimetria” entre l’hipòtesi nula i l’alternativa, i que això ho escull el practicant…</p>



<div class="slide-no">10</div>


<div class="slide-footer">104392 - Modelització i Inferència - 2020</div>

</article>
<article class="slide level-3" id="id7">

<h3>Al nostre exemple inicial (II):</h3>

<p>Per trobar el valor crític amb una significació de <span class="math notranslate nohighlight">\(\alpha=0.05\)</span>,
simularem <span class="math notranslate nohighlight">\(Y \sim \mbox{Geomètrica}(1 - (1-\rho_X)^K)\)</span> amb <span class="math notranslate nohighlight">\(\rho_X=0.01\)</span>,
i buscarem <span class="math notranslate nohighlight">\(T_0\)</span> tal que <span class="math notranslate nohighlight">\(P(T &gt; T_0 ; H_0) = \alpha = 0.05\)</span>:</p>
<a class="reference internal image-reference" href="../_images/geom_at_alpha.png"><img alt="../_images/geom_at_alpha.png" class="align-center" src="../_images/geom_at_alpha.png" style="height: 300px;" /></a>
<p class="note">Fixeu-vos que per tenir una significació de <span class="math notranslate nohighlight">\(\alpha=0.05\)</span>, només podrem
rebutjar l’hipòtesi Nula si <span class="math notranslate nohighlight">\(\hat{\rho}_x &gt; 0.022\)</span>! (això és en part perquè en el nostre exemple N=10).</p>



<div class="slide-no">11</div>


<div class="slide-footer">104392 - Modelització i Inferència - 2020</div>

</article>
<article class="slide level-3" id="id8">

<h3>Exercici contemporani:</h3>

<p>Considereu els tests PCR que es fan per detectar la COVID-19.</p>
<ul class="simple">
<li>Quina seria <span class="math notranslate nohighlight">\(H_0\)</span>? I <span class="math notranslate nohighlight">\(H_1\)</span>?</li>
<li>Què és un fals positiu? I un fals negatiu?</li>
<li>Què és pitjor, un fals positiu? o un fals negatiu?</li>
<li>Quin és l’estadístic del test?</li>
<li>Quina creieu que és la regió crítica del test?</li>
<li>Què creieu que vol dir que els tests PCR tenen “alta sensibilitat”?</li>
</ul>



<div class="slide-no">12</div>


<div class="slide-footer">104392 - Modelització i Inferència - 2020</div>

</article>
<article class="slide level-3" id="test-de-rao-de-versemblances">

<h3>Test de Raó de Versemblances</h3>

<p>El paradigma que hem explicat fins ara ens guia per escollir
el valor crític <span class="math notranslate nohighlight">\(T_0\)</span> quan ja tenim un estadístic de test <span class="math notranslate nohighlight">\(T\)</span> (
a l’exemple, <span class="math notranslate nohighlight">\(\hat{\rho}_X - 0.01\)</span>)
sobre el que treballar, i una idea sobre quina hauria de ser
la regió crítica (a l’exemple <span class="math notranslate nohighlight">\(T &gt; T_0\)</span>).</p>
<p>El següent Lemma estableix com construïr tests òptims per <strong>hipòtesis simples</strong>, és a dir
hipòtesis definides a partir del paràmetre <span class="math notranslate nohighlight">\(\theta\)</span> d’una població:</p>
<ul class="simple">
<li><span class="math notranslate nohighlight">\(H_0: \theta = \theta_0\)</span></li>
<li><span class="math notranslate nohighlight">\(H_1: \theta = \theta_1\)</span></li>
</ul>
<p class="note"><strong>Lema 4.1 (de Neyman-Pearson, 1933)</strong>: Per una mostra <span class="math notranslate nohighlight">\(X_1, \cdots, X_N\)</span> i <span class="math notranslate nohighlight">\(H_0\)</span> i <span class="math notranslate nohighlight">\(H_1\)</span>
hipòtesis simples, el test de raó de versemblances <span class="math notranslate nohighlight">\(T = \frac{f_X(X_1, \cdots, X_N; \theta_0)}{f_X(X_1, \cdots, X_N; \theta_1)}\)</span>
amb regió crítica <span class="math notranslate nohighlight">\(T &lt; T_0\)</span> tal que la significació és <span class="math notranslate nohighlight">\(\alpha\)</span>, és el test amb més potència amb nivell de significació <span class="math notranslate nohighlight">\(\alpha\)</span>.</p>



<div class="slide-no">13</div>


<div class="slide-footer">104392 - Modelització i Inferència - 2020</div>

</article>
<article class="slide level-3" id="id9">

<h3>Exemple d’aplicació: detecció per infra-rojos</h3>

<p>Considereu una mostra iid <span class="math notranslate nohighlight">\(X_1, \cdots, X_N\)</span> <strong>normal</strong> i de variança coneguda <span class="math notranslate nohighlight">\(\sigma_2\)</span>,
obtinguda a partir de les mesures d’un sensor de detecció d’infra-rojos. Quan davant del sensor
hi ha un objecte, es mesura una senyal amb mitja <span class="math notranslate nohighlight">\(\mu_1\)</span>, quan no, amb <span class="math notranslate nohighlight">\(\mu_0\)</span>.
Volem determinar si durant el periode d’observació de la mostra, hi havia un objecte o no:</p>
<ul class="simple">
<li><span class="math notranslate nohighlight">\(H_0\)</span>: no hi ha cap objecte, <span class="math notranslate nohighlight">\(\mu = \mu_0\)</span></li>
<li><span class="math notranslate nohighlight">\(H_1\)</span>: n’hi ha un, <span class="math notranslate nohighlight">\(\mu = \mu_1\)</span></li>
</ul>
<p>Com que es tracta d’hipòtesis simples, per Neyman-Pearson farem servir el test de raó de versemblances:</p>
<div class="math notranslate nohighlight">
\[\begin{split}T &amp;= \frac{f_X(X_1, \cdots, X_N; \theta_0)}{f_X(X_1, \cdots, X_N; \theta_1)} \\
  &amp;= \frac{\exp\left(-\frac{1}{2\sigma^2}\sum_i \left(X_i - \mu_0 \right)^2 \right)}{\exp\left(-\frac{1}{2\sigma^2}\sum_i \left(X_i - \mu_1 \right)^2 \right)} \\\end{split}\]</div>



<div class="slide-no">14</div>


<div class="slide-footer">104392 - Modelització i Inferència - 2020</div>

</article>
<article class="slide level-3" id="id10">

<h3>Test de Raó de Versemblances (3)</h3>

<div class="math notranslate nohighlight">
\[\begin{split}T &amp;= \exp\left(-\frac{1}{2\sigma^2}\left(\sum_i \left(X_i - \mu_0 \right)^2 - \sum_i \left(X_i - \mu_1 \right)^2 \right)\right) \\
  &amp;= \exp\left(-\frac{1}{2\sigma^2}\left(2N\bar{X}(\mu_0 - \mu_1) + N \mu_1^2 - N \mu_0^2\right)\right)\end{split}\]</div>
<p>Ens queda només trobar <span class="math notranslate nohighlight">\(T_0\)</span> tal que <span class="math notranslate nohighlight">\(P(T &lt; T_0; \mu_0) = \alpha\)</span>.
Com que <span class="math notranslate nohighlight">\(T\)</span> només depèn de la mostra a través de <span class="math notranslate nohighlight">\(\bar{X}\)</span>, la regió crítica
es pot expressar en funció d’<span class="math notranslate nohighlight">\(\bar{X}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \left\{T &lt; T_0 \right\} &amp;= \left\{2\bar{X}(\mu_0 - \mu_1) + \mu_1^2 - \mu_0^2 &gt; \frac{2 \sigma^2\log(T_0)}{N} \right\} \\
&amp; = \left\{\bar{X}(\mu_0 - \mu_1) &gt; X_0\right\}\end{split}\]</div>
<p>és a dir, enlloc de buscar <span class="math notranslate nohighlight">\(T_0\)</span> tal que <span class="math notranslate nohighlight">\(P(T &lt; T_0; \mu_0) = \alpha\)</span>,
buscarem directament <span class="math notranslate nohighlight">\(X_0\)</span> tal que <span class="math notranslate nohighlight">\(P(\bar{X}(\mu_0 - \mu_1) &gt; X_0; \mu_0) = \alpha\)</span>.</p>



<div class="slide-no">15</div>


<div class="slide-footer">104392 - Modelització i Inferència - 2020</div>

</article>

</section>

<section id="slide_notes">

</section>

  </body>
</html>